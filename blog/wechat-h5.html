<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VUE开发微信H5页面总结 | songStar</title>
    <meta name="description" content="写在前面 刚入门前端的时候写过很多的微信H5页面，时隔多年感觉应该是手到擒来，不曾想竟很是费了一些功夫。现在把本次开发过程中遇到的问题以及我是如何解决的，做个记录。防止自己以后再去解决解决过的问题。 github：github.com/qq9694526/v…">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no">
  <link rel="icon" href="logo.jpg">
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.225419fd.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.706b3cac.js" as="script"><link rel="preload" href="/my-blog/assets/js/6.6fb2a757.js" as="script"><link rel="preload" href="/my-blog/assets/js/47.04086129.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.f20c0927.js"><link rel="prefetch" href="/my-blog/assets/js/100.7809f206.js"><link rel="prefetch" href="/my-blog/assets/js/101.dceaeaaa.js"><link rel="prefetch" href="/my-blog/assets/js/102.2166ab77.js"><link rel="prefetch" href="/my-blog/assets/js/11.402fc41e.js"><link rel="prefetch" href="/my-blog/assets/js/12.18f04d56.js"><link rel="prefetch" href="/my-blog/assets/js/13.792cd0dc.js"><link rel="prefetch" href="/my-blog/assets/js/14.794a0f95.js"><link rel="prefetch" href="/my-blog/assets/js/15.1baaf28a.js"><link rel="prefetch" href="/my-blog/assets/js/16.e8528a34.js"><link rel="prefetch" href="/my-blog/assets/js/17.528eae15.js"><link rel="prefetch" href="/my-blog/assets/js/18.12a4f648.js"><link rel="prefetch" href="/my-blog/assets/js/19.c32d465a.js"><link rel="prefetch" href="/my-blog/assets/js/2.6d35d7f6.js"><link rel="prefetch" href="/my-blog/assets/js/20.b5eab002.js"><link rel="prefetch" href="/my-blog/assets/js/21.34707e99.js"><link rel="prefetch" href="/my-blog/assets/js/22.5736bd78.js"><link rel="prefetch" href="/my-blog/assets/js/23.0ff58a6d.js"><link rel="prefetch" href="/my-blog/assets/js/24.b92e78be.js"><link rel="prefetch" href="/my-blog/assets/js/25.3a4ff8e8.js"><link rel="prefetch" href="/my-blog/assets/js/26.35f36098.js"><link rel="prefetch" href="/my-blog/assets/js/27.2ff58f83.js"><link rel="prefetch" href="/my-blog/assets/js/28.8f05708c.js"><link rel="prefetch" href="/my-blog/assets/js/29.e8a6c0fb.js"><link rel="prefetch" href="/my-blog/assets/js/3.c5dd4370.js"><link rel="prefetch" href="/my-blog/assets/js/30.be85be13.js"><link rel="prefetch" href="/my-blog/assets/js/31.7b12e601.js"><link rel="prefetch" href="/my-blog/assets/js/32.845cdcf4.js"><link rel="prefetch" href="/my-blog/assets/js/33.a9ef2d22.js"><link rel="prefetch" href="/my-blog/assets/js/34.28123bb8.js"><link rel="prefetch" href="/my-blog/assets/js/35.91924054.js"><link rel="prefetch" href="/my-blog/assets/js/36.3d098b95.js"><link rel="prefetch" href="/my-blog/assets/js/37.f9ea8bee.js"><link rel="prefetch" href="/my-blog/assets/js/38.1da40108.js"><link rel="prefetch" href="/my-blog/assets/js/39.085516fd.js"><link rel="prefetch" href="/my-blog/assets/js/4.35303b03.js"><link rel="prefetch" href="/my-blog/assets/js/40.40556302.js"><link rel="prefetch" href="/my-blog/assets/js/41.ff071b5a.js"><link rel="prefetch" href="/my-blog/assets/js/42.31adb7f1.js"><link rel="prefetch" href="/my-blog/assets/js/43.40d693cf.js"><link rel="prefetch" href="/my-blog/assets/js/44.951ddac9.js"><link rel="prefetch" href="/my-blog/assets/js/45.df56ae23.js"><link rel="prefetch" href="/my-blog/assets/js/46.bd0e0a87.js"><link rel="prefetch" href="/my-blog/assets/js/48.02e7c638.js"><link rel="prefetch" href="/my-blog/assets/js/49.fdab2646.js"><link rel="prefetch" href="/my-blog/assets/js/5.b56ffffd.js"><link rel="prefetch" href="/my-blog/assets/js/50.e4810d7b.js"><link rel="prefetch" href="/my-blog/assets/js/51.93d76cf2.js"><link rel="prefetch" href="/my-blog/assets/js/52.c0f9f19e.js"><link rel="prefetch" href="/my-blog/assets/js/53.80750c84.js"><link rel="prefetch" href="/my-blog/assets/js/54.005fdf81.js"><link rel="prefetch" href="/my-blog/assets/js/55.ede6dc41.js"><link rel="prefetch" href="/my-blog/assets/js/56.61007681.js"><link rel="prefetch" href="/my-blog/assets/js/57.670c7201.js"><link rel="prefetch" href="/my-blog/assets/js/58.e9064fba.js"><link rel="prefetch" href="/my-blog/assets/js/59.62bc4999.js"><link rel="prefetch" href="/my-blog/assets/js/60.873559a3.js"><link rel="prefetch" href="/my-blog/assets/js/61.c92645b5.js"><link rel="prefetch" href="/my-blog/assets/js/62.9f044e1b.js"><link rel="prefetch" href="/my-blog/assets/js/63.d6ac5d93.js"><link rel="prefetch" href="/my-blog/assets/js/64.1354a376.js"><link rel="prefetch" href="/my-blog/assets/js/65.6b136df3.js"><link rel="prefetch" href="/my-blog/assets/js/66.9d673bdb.js"><link rel="prefetch" href="/my-blog/assets/js/67.13b34a5f.js"><link rel="prefetch" href="/my-blog/assets/js/68.4f9e59aa.js"><link rel="prefetch" href="/my-blog/assets/js/69.0e16aa0e.js"><link rel="prefetch" href="/my-blog/assets/js/7.3b8b5e87.js"><link rel="prefetch" href="/my-blog/assets/js/70.1f6ffead.js"><link rel="prefetch" href="/my-blog/assets/js/71.5e67d9ed.js"><link rel="prefetch" href="/my-blog/assets/js/72.6eee1d73.js"><link rel="prefetch" href="/my-blog/assets/js/73.a64254ca.js"><link rel="prefetch" href="/my-blog/assets/js/74.0e5065f3.js"><link rel="prefetch" href="/my-blog/assets/js/75.31dac096.js"><link rel="prefetch" href="/my-blog/assets/js/76.6751462a.js"><link rel="prefetch" href="/my-blog/assets/js/77.43140c2e.js"><link rel="prefetch" href="/my-blog/assets/js/78.5a709f02.js"><link rel="prefetch" href="/my-blog/assets/js/79.45d52b51.js"><link rel="prefetch" href="/my-blog/assets/js/8.12538955.js"><link rel="prefetch" href="/my-blog/assets/js/80.5305a1b8.js"><link rel="prefetch" href="/my-blog/assets/js/81.97bec44d.js"><link rel="prefetch" href="/my-blog/assets/js/82.92a14bc6.js"><link rel="prefetch" href="/my-blog/assets/js/83.d8ab0f51.js"><link rel="prefetch" href="/my-blog/assets/js/84.d02a950e.js"><link rel="prefetch" href="/my-blog/assets/js/85.8381bc93.js"><link rel="prefetch" href="/my-blog/assets/js/86.0445a778.js"><link rel="prefetch" href="/my-blog/assets/js/87.22a7f34e.js"><link rel="prefetch" href="/my-blog/assets/js/88.e9d6719f.js"><link rel="prefetch" href="/my-blog/assets/js/89.0063942f.js"><link rel="prefetch" href="/my-blog/assets/js/9.fa07b0c8.js"><link rel="prefetch" href="/my-blog/assets/js/90.1f5cad8a.js"><link rel="prefetch" href="/my-blog/assets/js/91.e4b5757b.js"><link rel="prefetch" href="/my-blog/assets/js/92.c5b2a611.js"><link rel="prefetch" href="/my-blog/assets/js/93.54482c42.js"><link rel="prefetch" href="/my-blog/assets/js/94.35174a27.js"><link rel="prefetch" href="/my-blog/assets/js/95.a8919596.js"><link rel="prefetch" href="/my-blog/assets/js/96.4e65f6cf.js"><link rel="prefetch" href="/my-blog/assets/js/97.7393dd35.js"><link rel="prefetch" href="/my-blog/assets/js/98.03a140a4.js"><link rel="prefetch" href="/my-blog/assets/js/99.b55b7ff0.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.225419fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="page-main"><header class="component-nav-menu nav-bar"><i class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></i> <div class="title">songStar</div> <div class="search-wrapper"><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-3867" class="el-autocomplete search-input no-focused"><div class="el-input el-input--prefix"><!----><input type="text" autocomplete="off" valueKey="title" placeholder="请输入内容" fetchSuggestions="function () { [native code] }" triggerOnFocus="true" debounce="300" placement="bottom-start" popperAppendToBody="true" background-color="#eee" value="" class="el-input__inner"><span class="el-input__prefix"><i class="el-input__icon el-icon-search"></i></span><!----><!----></div><div role="region" class="el-autocomplete-suggestion el-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div> <div class="sidebar-mask" style="display:none;"></div> <ul role="menubar" class="el-menu--horizontal el-menu nav-links" style="background-color:;"><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        Home
      </li><li role="menuitem" tabindex="-1" class="el-menu-item is-active" style="color:;border-bottom-color:;background-color:;">
        Blog
      </li><li role="menuitem" aria-haspopup="true" class="el-submenu"><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          docs
        <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;">
          es6
        </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;">
          typescript
        </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;">
          closure
        </li></ul></div></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        About
      </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        Github
      </li></ul></header> <!----> <div class="page-container"><div class="component-page"><div class="page-content"><!----> <div class="content default"><h1 id="vue开发微信h5页面总结"><a href="#vue开发微信h5页面总结" aria-hidden="true" class="header-anchor">#</a> VUE开发微信H5页面总结</h1> <p>转自：<a href="https://juejin.im/post/5c0490ef51882524cb6f5652#heading-5" target="_blank" rel="noopener noreferrer">VUE开发微信H5页面总结<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>刚入门前端的时候写过很多的微信H5页面，时隔多年感觉应该是手到擒来，不曾想竟很是费了一些功夫。现在把本次开发过程中遇到的问题以及我是如何解决的，做个记录。防止自己以后再去解决解决过的问题。
<strong>github</strong>：<a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fqq9694526%2Fvue-wxh5" target="_blank" rel="noopener noreferrer">github.com/qq9694526/v...<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="一、微信网页授权"><a href="#一、微信网页授权" aria-hidden="true" class="header-anchor">#</a> 一、微信网页授权</h2> <p>网页授权流程分为四步，这里只说前端需要做的，其中的第一步：跳转授权页面获取code。 这里分享下我的授权逻辑（下图），它有两个优点：</p> <ol><li>授权跳转在dom渲染之前，体验会好一些；</li> <li>本地存储了openId，前后端均不用频繁的与微信服务器交互。
<img src="https://user-gold-cdn.xitu.io/2018/12/3/16771e70c86266a7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></li></ol> <h2 id="二、微信jssdk授权"><a href="#二、微信jssdk授权" aria-hidden="true" class="header-anchor">#</a> 二、微信jssdk授权</h2> <p>如果你页面中有用到分享、上传图片、微信支付等功能，那么需要先进行js-sdk授权。我这边封装成了2个方法：initConfig和setShare，方便在路由/页面切换的时候重复调用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//main.js</span>
<span class="token keyword">import</span> wxsdk <span class="token keyword">from</span> <span class="token string">'./config/wxsdk.js'</span> <span class="token comment">//该模块提供initConfig和setShare方法，具体代码太长见github</span>
Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>wxsdk <span class="token operator">=</span> wxsdk<span class="token punctuation">;</span><span class="token comment">//挂载到全局</span>

<span class="token comment">//使用</span>
 <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>wxsdk<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>wxsdk<span class="token punctuation">.</span><span class="token function">setShare</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>openId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><h2 id="三、webpack-dev-server解决跨域"><a href="#三、webpack-dev-server解决跨域" aria-hidden="true" class="header-anchor">#</a> 三、webpack-dev-server解决跨域</h2> <p>讲真的所有跨域解决方案都必须有服务端的参与，诚然这个问题是浏览器抛出的，但让前端去解决真的很冤。下面两个配置让你永远告别跨域烦恼。本地开发用webpack-dev-server，测试生产环境用nginx。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//接口根路径http://47.105.59.***:9090/zt-wx</span>
<span class="token comment">//以vue-cli搭建的项目config举例 config/index.js</span>
  dev<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    proxyTable<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/zt-wx'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">'http://47.105.59.***:9090'</span><span class="token punctuation">,</span>  <span class="token comment">//目标接口域名</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span>  <span class="token comment">//是否跨域</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token comment">//实际发起请求时的url</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`/zt-wx/api/wx/info`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//http是我自己对axios的再封装  </span>

<span class="token comment">//nginx代理配置</span>
server <span class="token punctuation">{</span>
    location <span class="token operator">/</span>zt<span class="token operator">-</span>wx <span class="token punctuation">{</span>
    proxy_pass http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">47.105</span><span class="token number">.59</span><span class="token punctuation">.</span><span class="token operator">**</span><span class="token operator">*</span><span class="token punctuation">:</span><span class="token number">9090</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="四、iso初次加载白屏、跳转白屏"><a href="#四、iso初次加载白屏、跳转白屏" aria-hidden="true" class="header-anchor">#</a> 四、iso初次加载白屏、跳转白屏</h2> <p><strong>问题现象</strong>： ios页面初次加载白屏，刷新后正常，但切换到其他页面再后退，又会白屏。
<strong>问题原因</strong>：在ios机器上使用webview开发Vue项目时候，go history(-1)，无法将body的高度拉掉，使得内容被遮住了。
<strong>解决办法</strong>：html，body都是100%，#app撑起了父元素的告诉，但是浏览器默认的滚动scroll并不是#app，而是body,某些因素，造成返回history 后，无法复原（ios 的锅），为此，我们将#app进行了绝对定位，并让它重新成为 scroll 的对象，从而解决问题。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">#app</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>
  <span class="token property">-webkit-overflow-scrolling</span><span class="token punctuation">:</span> touch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、ios路由-跳转页面后分享失效"><a href="#五、ios路由-跳转页面后分享失效" aria-hidden="true" class="header-anchor">#</a> 五、ios路由/跳转页面后分享失效</h2> <p>问题现象：ios微信路由到另一个页面选择图片OK，但分享失效，刷新这个页面分享就正常了。
已累计尝试解决超过8小时，至今未果。
参考资料：<a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.zhihu.com%2Fquestion%2F59388458%2Fanswer%2F340351305" target="_blank" rel="noopener noreferrer">www.zhihu.com/question/59…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="六、上传图片报错：处理异常"><a href="#六、上传图片报错：处理异常" aria-hidden="true" class="header-anchor">#</a> 六、上传图片报错：处理异常</h2> <p>这个报错甚是诡异，因为前端和后端代码均没有&quot;处理异常&quot;这4个字。本来想甩锅给微信不管了的，但随后在做限制上传图片大小功能的时候阴差阳错的给解决了。
<strong>问题原因</strong>：后端tomcat服务默认设置表单提交数据大小上限为2M，大于2M就会报错。
<strong>解决办法</strong>：后端大神把server.xml中maxPostSize的值改为-1后解决。
参考资料：<a href="https://link.juejin.im?target=https%3A%2F%2Fblog.csdn.net%2Fw18756901575%2Farticle%2Fdetails%2F79374621" target="_blank" rel="noopener noreferrer">blog.csdn.net/w1875690157...<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="七、正确导出图片格式"><a href="#七、正确导出图片格式" aria-hidden="true" class="header-anchor">#</a> 七、正确导出图片格式</h2> <p>这个项目首页基本是由图片堆砌成的，一开始切出来的图(默认.png)压缩后在400k-1.3M之间。一开始还以为PSD素材有问题。直到项目最后才闪回，想起图片格式的知识点，改导出成.jpg格式后压缩出来的图片基本控制在100K以内了。具体的.png.jpg这些图片格式的知识有兴趣的自己查。</p> <h2 id="八、vuex使用之同步用户信息"><a href="#八、vuex使用之同步用户信息" aria-hidden="true" class="header-anchor">#</a> 八、vuex使用之同步用户信息</h2> <p>讲道理小项目是不应该用vuex的，但是用着确实爽，即简单又省心省力。由于我总是忘记它的方法名，所以在这里贴下代码，方便以后随时cv。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//config/store.js</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        user<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations：<span class="token punctuation">{</span>
        <span class="token function">updateUser</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
            state<span class="token punctuation">.</span>user <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//在组件中使用</span>
computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在需要的时候更新数据</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;updateUser&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="九、使用html2canvas生成的海报不显示图片"><a href="#九、使用html2canvas生成的海报不显示图片" aria-hidden="true" class="header-anchor">#</a> 九、使用html2canvas生成的海报不显示图片</h2> <p><strong>问题原因</strong>：引入的图片资源路径跨域造成的。
<strong>解决办法</strong>：我先是按照官方给的那个php的方案弄的，未能解决。最后舔着脸让后端大佬把图片资源目录挪到我web服务目录下给解决的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//安装</span>
npm install <span class="token operator">--</span>save html2canvas
<span class="token comment">//引入</span>
<span class="token keyword">import</span> html2canvas <span class="token keyword">from</span> <span class="token string">&quot;html2canvas&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//使用</span>
<span class="token keyword">const</span> myPosterWrap <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;posterWrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">html2canvas</span><span class="token punctuation">(</span>myPosterWrap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>canvas <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>posterSrc <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadPosterImg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>posterSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="十、css黑科技之放置指定比例的图片"><a href="#十、css黑科技之放置指定比例的图片" aria-hidden="true" class="header-anchor">#</a> 十、css黑科技之放置指定比例的图片</h2> <p>就是把不定宽图片按指定比例显示，直接上码（1：1.25）。</p> <div class="language-html extra-class"><pre class="language-html"><code>//html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>poster-img-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>poster-img-place<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>poster-img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>user.picAddress<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">//less
.poster-img-wrap</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 28%<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token selector">;
    .poster-img-place</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">padding-top</span><span class="token punctuation">:</span> 125%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.poster-img</span> <span class="token punctuation">{</span>
        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十一、ios页面加载不全不能滚动"><a href="#十一、ios页面加载不全不能滚动" aria-hidden="true" class="header-anchor">#</a> 十一、ios页面加载不全不能滚动</h2> <p><strong>问题描述</strong> ：ios从首页进入，跳转其他页面再后退到首页，首页只显示一屏内容且无法滚动。 <strong>问题原因</strong>：在于ios浏览器内核的别致渲染逻辑：它会预先找到相应的overflow: scroll元素，如果子元素高度高于父元素，则建立原生的scrollView实现滚动。问题就出现在这个&quot;预先&quot;上，它预先获取的高度并不是子元素渲染后的真实高度。 <strong>解决办法</strong>：给设置了滚动的#app元素下的子元素p-index设置min-height: calc(100% + 1px);</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">#app</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>
  <span class="token property">-webkit-overflow-scrolling</span><span class="token punctuation">:</span> touch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.p-index</span><span class="token punctuation">{</span>
   <span class="token property">min-height</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% + 1px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其实能解决全靠这篇博文，这里就不赘述了。<a href="https://link.juejin.im?target=https%3A%2F%2Fblog.csdn.net%2Fnongweiyilady%2Farticle%2Fdetails%2F83039868" target="_blank" rel="noopener noreferrer">blog.csdn.net/nongweiyila...<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
神奇的是，我能看到这篇文章全来赖于地铁上无聊打开了很久没打开的CSDNapp，切到前端分类，&quot;不滚动&quot;三个字立马映入眼帘，点进去的第一眼 ，就感觉是对的人了。迷茫的时候就看书，古人诚不我欺！</p> <h2 id="一些忠告"><a href="#一些忠告" aria-hidden="true" class="header-anchor">#</a> 一些忠告</h2> <blockquote></blockquote> <ul><li>能小程序就别网页开发；</li> <li>不意淫不揣摩待定的需求；</li> <li>坚持看图作业的优良传统；</li> <li>迷茫的时候就看书，焦虑的时候去学习；</li></ul></div> <div class="page-nav"><div class="pre"><!----></div> <div class="next"><!----></div></div> <div class="vcomment content"><div id="vcomments"></div></div></div> <!----></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.706b3cac.js" defer></script><script src="/my-blog/assets/js/6.6fb2a757.js" defer></script><script src="/my-blog/assets/js/47.04086129.js" defer></script>
  </body>
</html>
